@model IEnumerable<Web.Models.Entidad.EntidadViewModel>

@{
    ViewBag.Title = "Entidades";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<script src="http://maps.google.com/maps/api/js?sensor=true" type="text/javascript"></script>

<style>
    #map_canvas img {
        max-width: none;
    }
</style>

<div class="panel panel-primary">
    <div class="panel-heading"><font size="5">Entidades</font></div>
    <div class="panel-body">
        <div class="panel panel-default">
            <div class="panel-heading"><font size="4">Entidades en Mapa</font></div>
            <div class="panel-body">
                @foreach (var item in Model)
                {
                    <div class="foo" data-latitude="@(item.Posicion.latitud)"
                                     data-longitude="@(item.Posicion.longitud)">
                    </div>
                }
                <div id="map_canvas" style="height: 600px;"></div>
            </div>
        </div>
    </div>
</div>

@section scripts {
    <section class="scripts">
        <script type="text/javascript">
            $(document).ready(function () {
                initialize();
            });

            function initialize() {
                var foos = $(".foo");
                var markers = new Array();
                var Area = new google.maps.LatLng(-34.603722, -58.381592);  // Buenos Aires
                var mapOptions = {
                    zoom: 6,
                    center: Area,
                    mapTypeId: google.maps.MapTypeId.G_NORMAL_MAP
                };
                var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
                
                $.each(foos, function (key, value) {
                    markers[key] = new google.maps.Marker({
                    map: map,
                    draggable: false,
                    animation: google.maps.Animation.DROP,
                    position: new google.maps.LatLng(
                        Number($(value).attr("data-latitude")),
                        Number($(value).attr("data-longitude"))
                        )
                    });
                    // no llega dato
                });
            }
        </script>
    </section>
}